
<!DOCTYPE html>
<html>
<head>
  <title>ê´€ë¦¬ì í†µê³„</title>
  <meta charset="UTF-8">
  <style>
    body { font-family: sans-serif; padding: 30px; background: #f9f9f9; }
    h2 { margin-top: 40px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f0f0f0; }
  </style>
</head>
<body>

  <div id="content" style="display: none;">
    <h1>ğŸ“Š ì‹¤ì‹œê°„ í†µê³„ ëŒ€ì‹œë³´ë“œ</h1>
    <div id="summary">ë¡œë”© ì¤‘...</div>
    <div id="tables"></div>
  </div>

<script>
function renderStats(data) {
  let totalVisits = 0;
  let totalClicks = 0;
  let html = "";

  for (const date in data.visits) {
    html += `<h2>${date}</h2><table><tr><th>ì‹œê°„</th><th>ë°©ë¬¸ì</th><th>í´ë¦­ìˆ˜</th></tr>`;
    const hours = data.visits[date];
    for (const hour in hours) {
      const v = hours[hour] || 0;
      const c = (data.clicks[date] && data.clicks[date][hour]) || 0;
      totalVisits += v;
      totalClicks += c;
      html += `<tr><td>${hour}</td><td>${v}</td><td>${c}</td></tr>`;
    }
    html += `</table>`;
  }

  document.getElementById("summary").innerHTML = `âœ… ì´ ë°©ë¬¸ì: <b>${totalVisits}</b>ëª… / ì´ í´ë¦­: <b>${totalClicks}</b>íšŒ`;
  document.getElementById("tables").innerHTML = html;
}

function loadStats() {
  fetch("https://anan14.onrender.com/api/stats")
    .then(res => res.json())
    .then(renderStats)
    .catch(() => {
      document.getElementById("summary").innerText = "âŒ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨";
      document.getElementById("tables").innerHTML = "";
    });
}

document.addEventListener("DOMContentLoaded", function () {
  const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”");
  if (pw !== "1234") {
    document.body.innerHTML = "<h2 style='color:red;'>â›” ì ‘ê·¼ ë¶ˆê°€: ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.</h2>";
    throw new Error("Unauthorized");
  }
  document.getElementById("content").style.display = "block";
  loadStats();
  setInterval(loadStats, 5000);
});
</script>

</body>
</html>
